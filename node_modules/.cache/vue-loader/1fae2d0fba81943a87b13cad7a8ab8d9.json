{"remainingRequest":"/Users/catherine/workspace/sublimeWorkspace/front-res/vue/app-project/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/catherine/workspace/sublimeWorkspace/front-res/vue/app-project/src/components/monitorTest/monitor-view.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/catherine/workspace/sublimeWorkspace/front-res/vue/app-project/src/components/monitorTest/monitor-view.vue","mtime":1579232796728},{"path":"/Users/catherine/workspace/sublimeWorkspace/front-res/vue/app-project/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/catherine/workspace/sublimeWorkspace/front-res/vue/app-project/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/catherine/workspace/sublimeWorkspace/front-res/vue/app-project/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/catherine/workspace/sublimeWorkspace/front-res/vue/app-project/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBdHRyVGV4dCBmcm9tICIuL21vbml0b3JDb21wL2F0dHItdGV4dCI7CmltcG9ydCBidXMgZnJvbSAiLi91dGlsL2V2ZW50QnVzLmpzIjsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJtb25pdG9yLXZpZXciLAogICAgY29tcG9uZW50czoge0F0dHJUZXh0fSwKICAgIHByb3BzOiB7CiAgICAgICAgZGV2aWNlOiB7CiAgICAgICAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpZDogJzAwMDEnLAogICAgICAgICAgICAgICAgICAgIG5hbWU6ICforr7lpIcwMDAxJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIGNyZWF0ZWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLmZldGNoRGF0YSgpOwogICAgICAgIGxldCBfdGhpcyA9IHRoaXM7CiAgICAgICAgYnVzLiRvbignc3RhdHVzQ2hhbmdlJywgZnVuY3Rpb24gKHN0YXR1c09iaikgewogICAgICAgICAgICBsZXQga2V5ID0gT2JqZWN0LmtleXMoc3RhdHVzT2JqKVswXTsKICAgICAgICAgICAgX3RoaXMuc3RhdHVzT2JqW2tleV0gPSBzdGF0dXNPYmpba2V5XTsKICAgICAgICAgICAgX3RoaXMuc3RhdHVzID0gT2JqZWN0LnZhbHVlcyhfdGhpcy5zdGF0dXNPYmopLnJlZHVjZSgoYSxiKT0+YT5iP2E6Yik7CiAgICAgICAgfSkKICAgIH0sCiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc3RhdHVzOiAwLC8vIDDmraPluLggMemihOitpiAgMiDplJnor68KICAgICAgICAgICAgcHJvcFNob3dDb25maWc6IHsKICAgICAgICAgICAgICAgIGNvbHVtbk51bTogMSwKICAgICAgICAgICAgICAgIGNvbW1vbjogMSwvLzEg6ZSu5YC85a+5ICAyIOW4puWbvumUruWAvOWvuQogICAgICAgICAgICAgICAgdmFsdWVTaG93VHlwZTogMSwvLyAxIGxlZnQvcmlnaHQgIDIgdG9wL2JvdHRvbQogICAgICAgICAgICB9LAogICAgICAgICAgICBkYXRhUnVsZXM6IHt9LAogICAgICAgICAgICBkYXRhT2JqOiBbXSwKICAgICAgICAgICAgdXBkYXRlSW50ZXJ2YWxJRDogJycsCiAgICAgICAgICAgIHVwZGF0ZUludGVydmFsOiA1MDAwLAogICAgICAgICAgICBzdGF0dXNPYmo6e30KICAgICAgICB9CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBkYXRhR3JvdXA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgbGV0IGRhdGFHcm91cCA9IFtdOwogICAgICAgICAgICBsZXQgdG1wID0gdGhpcy5kYXRhT2JqLnNsaWNlKCk7CiAgICAgICAgICAgIHdoaWxlICh0bXAubGVuZ3RoICYmIHRtcC5sZW5ndGggPj0gdGhpcy5wcm9wU2hvd0NvbmZpZy5jb2x1bW5OdW0pIHsKICAgICAgICAgICAgICAgIGxldCByb3cgPSB0bXAuc2xpY2UoMCwgdGhpcy5wcm9wU2hvd0NvbmZpZy5jb2x1bW5OdW0pOwogICAgICAgICAgICAgICAgZGF0YUdyb3VwLnB1c2gocm93KTsKICAgICAgICAgICAgICAgIHRtcC5zcGxpY2UoMCwgdGhpcy5wcm9wU2hvd0NvbmZpZy5jb2x1bW5OdW0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0bXAubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBkYXRhR3JvdXAucHVzaCh0bXAuc2xpY2UoMCwgdG1wLmxlbmd0aCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBkYXRhR3JvdXA7CiAgICAgICAgfSwKICAgICAgICBzdGF0dXNDbGFzczogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBsZXQgYmNsYXNzID0gdGhpcy5zdGF0dXMgPT09IDEgPyAnc3RhdHVzLXdhcm4nIDogdGhpcy5zdGF0dXMgPT09IDIgPyAnc3RhdHVzLWVycm9yJyA6ICdzdGF0dXMtY29tbW9uJzsKICAgICAgICAgICAgY29uc29sZS5sb2coYmNsYXNzKTsKICAgICAgICAgICAgcmV0dXJuIGJjbGFzczsKICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGZldGNoRGF0YTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvL+afpeaJvmRhdGFSdWxl6KeE5YiZCiAgICAgICAgICAgIHRoaXMuZGF0YVJ1bGVzID0gewogICAgICAgICAgICAgICAgcmF0ZWRDYXBhY2l0eTogewogICAgICAgICAgICAgICAgICAgIG1heDogewogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogNjAsCiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm5WYWx1ZTogNTMKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG1pbjogewogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm5WYWx1ZTogMjUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZW1wdHlMb3NzOiB7CiAgICAgICAgICAgICAgICAgICAgbWF4OiB7dmFsdWU6IDAuOH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICByYXRlZEVsZWM6IHsKICAgICAgICAgICAgICAgICAgICBtaW46IHt2YWx1ZTogMi40fSwKICAgICAgICAgICAgICAgICAgICBtYXg6IHt2YWx1ZTogNy4yfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGxvYWRMb3NzOiB7CiAgICAgICAgICAgICAgICAgICAgbWF4OiB7dmFsdWU6IDAuN30KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIC8v5p+l5om+ZGF0YU9iagogICAgICAgICAgICB0aGlzLmRhdGFPYmogPSBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgImF0dHIiOiAicmF0ZWRDYXBhY2l0eSIsCiAgICAgICAgICAgICAgICAgICAgImxhYmVsIjogIumineWumuWuuemHjyIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogNTEsCiAgICAgICAgICAgICAgICAgICAgInVuaXQiOiAi77yIa1ZB77yJIiwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgImF0dHIiOiAiZW1wdHlMb3NzIiwKICAgICAgICAgICAgICAgICAgICAibGFiZWwiOiAi56m66L295o2f6ICXIiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAwLjIsCiAgICAgICAgICAgICAgICAgICAgInVuaXQiOiAi77yIa1fvvIkiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJhdHRyIjogInJhdGVkRWxlYyIsCiAgICAgICAgICAgICAgICAgICAgImxhYmVsIjogIumineWumueUtea1gSIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogMS44LAogICAgICAgICAgICAgICAgICAgICJ1bml0IjogIu+8iEHvvIkiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJhdHRyIjogImxvYWRMb3NzIiwKICAgICAgICAgICAgICAgICAgICAibGFiZWwiOiAi6LSf6L295o2f6ICXIiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAwLjIsCiAgICAgICAgICAgICAgICAgICAgInVuaXQiOiAi77yIa1fvvIkiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdOwogICAgICAgICAgICAvL+iuvue9ruWumuaXtuWZqO+8jOWKqOaAgeabtOaWsAogICAgICAgICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgICAgICAgIHRoaXMudXBkYXRlSW50ZXJ2YWxJRCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHRoYXQuZGF0YU9iaiA9IHRoYXQuZGF0YU9iai5tYXAoeCA9PiB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHRtcCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoeCkpOwogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IE51bWJlci5wYXJzZUZsb2F0KHRtcC52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmRvbU51bSA9IHZhbHVlID4gMSA/IDEgOiAwLjE7CiAgICAgICAgICAgICAgICAgICAgdG1wLnZhbHVlID0gdmFsdWUgJSAxID09PSAwID8gdmFsdWUgKyByYW5kb21OdW0gOiAodmFsdWUgKyByYW5kb21OdW0pLnRvRml4ZWQoMSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRtcDsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sIHRoYXQudXBkYXRlSW50ZXJ2YWwpOwogICAgICAgIH0KICAgIH0sCiAgICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnVwZGF0ZUludGVydmFsSUQpOwogICAgfQp9Cg=="},{"version":3,"sources":["monitor-view.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"monitor-view.vue","sourceRoot":"src/components/monitorTest","sourcesContent":["<template>\n    <table class=\"obj-table\">\n        <tr>\n            <th :colspan=\"propShowConfig.columnNum\">{{device.name}}<span class=\"status-circle\"\n                                                                         :class=\"statusClass\"></span></th>\n        </tr>\n        <tr v-for=\"(data,index) in dataGroup\" :key=\"index\">\n            <td v-for=\"(item,index) in data\" :key=\"index\">\n                <attr-text :item=\"item\" :attr-rules=\"dataRules[item.attr]\"></attr-text>\n            </td>\n        </tr>\n    </table>\n</template>\n\n<script>\n    import AttrText from \"./monitorComp/attr-text\";\n    import bus from \"./util/eventBus.js\";\n\n    export default {\n        name: \"monitor-view\",\n        components: {AttrText},\n        props: {\n            device: {\n                type: Object,\n                default: () => {\n                    return {\n                        id: '0001',\n                        name: '设备0001'\n                    }\n                }\n            }\n        },\n        created: function () {\n            this.fetchData();\n            let _this = this;\n            bus.$on('statusChange', function (statusObj) {\n                let key = Object.keys(statusObj)[0];\n                _this.statusObj[key] = statusObj[key];\n                _this.status = Object.values(_this.statusObj).reduce((a,b)=>a>b?a:b);\n            })\n        },\n        data: function () {\n            return {\n                status: 0,// 0正常 1预警  2 错误\n                propShowConfig: {\n                    columnNum: 1,\n                    common: 1,//1 键值对  2 带图键值对\n                    valueShowType: 1,// 1 left/right  2 top/bottom\n                },\n                dataRules: {},\n                dataObj: [],\n                updateIntervalID: '',\n                updateInterval: 5000,\n                statusObj:{}\n            }\n        },\n        computed: {\n            dataGroup: function () {\n                let dataGroup = [];\n                let tmp = this.dataObj.slice();\n                while (tmp.length && tmp.length >= this.propShowConfig.columnNum) {\n                    let row = tmp.slice(0, this.propShowConfig.columnNum);\n                    dataGroup.push(row);\n                    tmp.splice(0, this.propShowConfig.columnNum);\n                }\n                if (tmp.length) {\n                    dataGroup.push(tmp.slice(0, tmp.length));\n                }\n                return dataGroup;\n            },\n            statusClass: function () {\n                let bclass = this.status === 1 ? 'status-warn' : this.status === 2 ? 'status-error' : 'status-common';\n                console.log(bclass);\n                return bclass;\n            }\n        },\n        methods: {\n            fetchData: function () {\n                //查找dataRule规则\n                this.dataRules = {\n                    ratedCapacity: {\n                        max: {\n                            value: 60,\n                            warnValue: 53\n                        },\n                        min: {\n                            value: 20,\n                            warnValue: 25\n                        }\n                    },\n                    emptyLoss: {\n                        max: {value: 0.8}\n                    },\n                    ratedElec: {\n                        min: {value: 2.4},\n                        max: {value: 7.2}\n                    },\n                    loadLoss: {\n                        max: {value: 0.7}\n                    }\n\n                };\n                //查找dataObj\n                this.dataObj = [\n                    {\n                        \"attr\": \"ratedCapacity\",\n                        \"label\": \"额定容量\",\n                        \"value\": 51,\n                        \"unit\": \"（kVA）\",\n                    },\n                    {\n                        \"attr\": \"emptyLoss\",\n                        \"label\": \"空载损耗\",\n                        \"value\": 0.2,\n                        \"unit\": \"（kW）\"\n                    },\n                    {\n                        \"attr\": \"ratedElec\",\n                        \"label\": \"额定电流\",\n                        \"value\": 1.8,\n                        \"unit\": \"（A）\"\n                    },\n                    {\n                        \"attr\": \"loadLoss\",\n                        \"label\": \"负载损耗\",\n                        \"value\": 0.2,\n                        \"unit\": \"（kW）\"\n                    },\n                ];\n                //设置定时器，动态更新\n                let that = this;\n                this.updateIntervalID = setInterval(function () {\n                    that.dataObj = that.dataObj.map(x => {\n                        let tmp = JSON.parse(JSON.stringify(x));\n                        let value = Number.parseFloat(tmp.value);\n                        let randomNum = value > 1 ? 1 : 0.1;\n                        tmp.value = value % 1 === 0 ? value + randomNum : (value + randomNum).toFixed(1);\n                        return tmp;\n                    })\n                }, that.updateInterval);\n            }\n        },\n        beforeDestroy: function () {\n            clearInterval(this.updateIntervalID);\n        }\n    }\n</script>\n\n<style scoped>\n    th {\n        border-bottom: 1px solid cornflowerblue;\n    }\n\n    .obj-table {\n        border: 1px solid cornflowerblue;\n    }\n\n    .status-circle {\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        border-radius: 10px;\n        margin-left: 10px;\n    }\n\n    .status-common {\n        background: #00af00;\n        box-shadow: 0px 0px 5px #00af00;\n    }\n\n    .status-warn {\n        background: #e2e05a;\n        box-shadow: 0px 0px 5px #e2e05a;\n    }\n\n    .status-error {\n        background: red;\n        box-shadow: 0px 0px 5px red;\n    }\n</style>"]}]}